p_vals <- read.csv("D:/Documents/projects/SCZ_human_cortex/results/Cell_type_abundance/all_cells/Pval_df_2.csv")
p_vals
p_vals$X
p_vals$X2
p_vals$X
p_vals$x
fdrs <- p.adjust(p_vals$x,methos="BH")
fdrs <- p.adjust(p_vals$x,methods="BH")
fdrs <- p.adjust(p_vals$x,method="BH")
fdrs
load("~/projects/SCZ_human_cortex/code/GRN_inference/hdWGCNA/TOM/Excitatory_Layer_5-6_IT_neurons_I__norm_basic_TOM.rda")
consTomDS
dim(consTomDS)
length(consTomDS)
library("ggraph")
library("tidygraph")
main_path <- "D:/Documents/projects/SCZ_human_cortex/code/GRN_inference/hdWGCNA/"
TOM_path <- paste0(main_path,"TOM/")
lis.files(TOM_path)
list.files(TOM_path)
colnames(TOM)
columns(TOM)
col.names(TOM)
graph <- TOM %>%
igraph::graph_from_adjacency_matrix(mode='undirected', weighted=TRUE) %>%
tidygraph::as_tbl_graph(directed=FALSE) %>%
tidygraph::activate(nodes)
TOM <- consTomDS
rm(consTomDS)
graph <- TOM %>%
igraph::graph_from_adjacency_matrix(mode='undirected', weighted=TRUE) %>%
tidygraph::as_tbl_graph(directed=FALSE) %>%
tidygraph::activate(nodes)
rm(TOM)
read.table("Astrocytes__norm_basic_TOM.rda")
main_path <- "D:/Documents/projects/SCZ_human_cortex/code/GRN_inference/hdWGCNA/"
TOM_path <- paste0(main_path,"TOM/")
read.table(paste0(TOM_path,"Astrocytes__norm_basic_TOM.rda"))
TOM <- read.table(paste0(TOM_path,CTs[0]))
# date:  28th Februari 2024
# version: 0.0.1
library("ggraph")
library("tidygraph")
##### SETTINGS #####
main_path <- "D:/Documents/projects/SCZ_human_cortex/code/GRN_inference/hdWGCNA/"
TOM_path <- paste0(main_path,"TOM/")
CTs <- list.files(TOM_path)
TOM <- read.table(paste0(TOM_path,CTs[0]))
CTs[0]
CTs
CTs[1]
TOM <- read.table(paste0(TOM_path,CTs[2]))
TOM <- read.table(paste0(TOM_path,CTs[2]),fill=TRUE)
TOM$V1
TOM$V1
TOM
TOM <- read.table(paste0(TOM_path,CTs[2]),fill=TRUE)
TOM <- read.table(paste0(TOM_path,CTs[2]),fill=TRUE,fileEncoding = "UTF16LE")
TOM <- read.table(paste0(TOM_path,CTs[2]),fill=TRUE,fileEncoding = "UCS-2LE")
TOM <- read.table(paste0(TOM_path,CTs[2]),fill=TRUE,fileEncoding = "UCS-2LE",skipNul=TRUE)
TOM <- read.table(paste0(TOM_path,CTs[2]),fill=TRUE,skipNul=TRUE)
TOM <- read.table(paste0(TOM_path,CTs[2]),fill=TRUE,fileEncoding = "utf-8")
TOM
TOM <- read.table(paste0(TOM_path,CTs[1]),fill=TRUE,fileEncoding = "utf-8")
TOM
TOM <- read.table(paste0(TOM_path,CTs[1]),fill=TRUE,fileEncoding = "utf-8",header=TRUE)
TOM <- read.table(paste0(TOM_path,CTs[1]),fill=TRUE,fileEncoding = "us-ascii",header=TRUE)
TOM <- read.table(paste0(TOM_path,CTs[1]),fill=TRUE,fileEncoding = "us-ascii",header=TRUE,sep=",")
TOM <- read.table(paste0(TOM_path,CTs[1]),fill=TRUE,fileEncoding = "us-ascii",sep=",")
TOM <- read.table(paste0(TOM_path,CTs[1]),fill=TRUE,fileEncoding = "us-ascii",header=TRUE,sep=",")
TOM <- read.table(paste0(TOM_path,CTs[1]),fill=TRUE,fileEncoding = "us-ascii",header=TRUE,sep=",",blank.lines.skip = TRUE)
TOM <- read.table(paste0(TOM_path,CTs[1]),fill=TRUE,fileEncoding = "UTF-16LE",header=TRUE,sep=",")
TOM <- read.table(file=paste0(TOM_path,CTs[1]),fill=TRUE,fileEncoding = "UTF-16LE",header=TRUE,sep=",")
TOM <- read.table(file=paste0(TOM_path,CTs[1]))
TOM <- read.table(file=paste0(TOM_path,CTs[1]),fill=TRUE)
TOM <- read.table(file=paste0(TOM_path,CTs[1]),fill=TRUE,sep="\")
TOM <- read.table(file=paste0(TOM_path,CTs[1]),fill=TRUE,sep="\t")
TOM <- read.table(file=paste0(TOM_path,CTs[1]),fill=TRUE,sep="\t")
TOM <- read.table(file=paste0(TOM_path,CTs[1]),fill=TRUE,sep="\t", fileEncoding = "UTF-16LE")
TOM <- read.table(file=paste0(TOM_path,CTs[1]),fill=TRUE,sep="\t", fileEncoding = "UTF-16LE",header=TRUE)
path_project <- "D:/Documents/projects/SCZ_human_cortex/"
path_gene_lists <- paste0(path_project, "data/Gene_lists/")
#load TF list Elin:
TF_list = read.csv(paste0(path_gene_lists,"SelectedTFs_ensgid_EG_Elin.csv"))
mouse_human_genes <- read.csv(paste0(path_gene_lists,"http://www.informatics.jax.org/downloads/reports/HOM_MouseHumanSequence.rpt"),sep="\t")
mouse_human_genes <- read.csv("http://www.informatics.jax.org/downloads/reports/HOM_MouseHumanSequence.rpt",sep="\t")
mouse <- split.data.frame(mouse_human_genes,mouse_human_genes$Common.Organism.Name)[[2]]
human <- split.data.frame(mouse_human_genes,mouse_human_genes$Common.Organism.Name)[[1]]
mouse <- mouse[,c(1,4)]
human <- human[,c(1,4)]
mh_data <- merge.data.frame(mouse,human,by = "DB.Class.Key",all.y = TRUE)
mouse <- split.data.frame(mouse_human_genes,mouse_human_genes$Common.Organism.Name)[[2]]
human <- split.data.frame(mouse_human_genes,mouse_human_genes$Common.Organism.Name)[[1]]
mouse <- mouse[,c(1,4)]
human <- human[,c(1,4)]
mh_data <- mh_data[,c(2,3)]
TF_list_with_human_gene_name <- merge.data.frame(TF_list,mh_data,by.x="TF",by.y="Symbol.x",all.x = TRUE)
TF_list_with_human_gene_name <- merge.data.frame(TF_list,mh_data,by.x="TF",by.y="Symbol.x")
TF_list_with_human_gene_name <- merge.data.frame(TF_list,mh_data,by.x="TF",by.y="Symbol.x", all.x=TRUE)
TF_list_with_human_gene_name <- merge(TF_list,mh_data,by.x="TF",by.y="Symbol.x", all.x=TRUE)
rm(TF_list_with_human_gene_name)
TF_list_with_human_gene_name <- merge(TF_list,mh_data,by.x="TF",by.y="Symbol.x", all.x=TRUE)
TF_list_with_human_gene_name <- merge(TF_list,mh_data,by.x="TF",by.y="Symbol.x", all.x=TRUE, all.y = FALSE)
head(TF_list_with_human_gene_name )
head(TF_list)
na.omit(TF_list_with_human_gene_name)
TF_list_with_human_gene_name <- na.omit(TF_list_with_human_gene_name)
write.csv(TF_list_with_human_gene_name, paste0(path_gene_lists,"SelectedTFs_EG_Elin_human_gene_names.csv"), row.names=FALSE)
library(Seurat)
library(SeuratDisk)
library(harmony)
# plotting and data science packages
library(tidyverse)
library(cowplot)
library(patchwork)
library(gridExtra)
library(ggforestplot)
library(ggrepel)
# co-expression network analysis packages:
library(WGCNA)
library(hdWGCNA)
packageVersion(Seurat)
packageVersion("Seurat")
packageVersion("pagoda2")
packageVersion("stringr")
packageVersion("GGally")
packageVersion("corrgram")
packageVersion("corrplot")
packageVersion("factoextra")
packageVersion("loomR")
packageVersion("SingleCellExperiment")
packageVersion("scmap")
packageVersion("iotools")
packageVersion("pryr")
packageVersion("pheatmap")
packageVersion("irr")
packageVersion("doParallel")
packageVersion("foreach")
packageVersion("Matrix")
packageVersion("conos")
packageVersion("SeuratObject")
packageVersion("dplyr")
packageVersion("patchwork")
packageVersion("ggplot2")
packageVersion("stringr")
packageVersion("magrittr")
packageVersion("RColorBrewer")
packageVersion("cacoa")
packageVersion("trqwe")
packageVersion("coda.base")
packageVersion("reshape")
packageVersion("ggpubr")
packageVersion("ggbreak")
packageVersion("cowplot")
packageVersion("openxlsx")
packageVersion("varhandle")
packageVersion("ape")
packageVersion("DESeq2")
packageVersion("RUVseq")
packageVersion("variancePartition")
packageVersion("reshape2")
packageVersion("readxl")
packageVersion("tidyvers")
packageVersion("tidyverse")
packageVersion("earth")
packageVersion("VIM")
packageVersion("mice")
packageVersion("caret")
packageVersion("sjmisc")
packageVersion("UpSetR")
packageVersion("ComplexUpSet")
packageVersion("glmGamPoi")
packageVersion("BiocParallel")
packageVersion("IHW")
packageVersion("ashr")
packageVersion("scuttle")
packageVersion("data.table")
packageVersion("rstatix")
packageVersion("rrvgo")
packageVersion("tidyr")
packageVersion("clusterProfiler")
packageVersion("SeuratDisk")
packageVersion("harmony")
packageVersion("tidyverse")
packageVersion("hdWGCNA")
packageVersion("WGCNA")
packageVersion("plyr")
packageVersion("pracma")
packageVersion("gridExtra")
packageVersion("ggforestplot")
packageVersion("ggrepel")
packageVersion("igraph")
packageVersion("gprofiler2")
packageVersion("GeneOverlap")
packageVersion("tictoc")
packageVersion("ggraph")
packageVersion("tidygraph")
packageVersion("scITD")
setwd("~/projects/SCZ_human_cortex/publication/code_updated/5d_cell_cell_communication/script")
setwd("D:/Documents/projects/SCZ_human_cortex/publication/code_updated/5d_cell_cell_communication/script")
setwd("D:/Documents/projects/SCZ_human_cortex/publication/code_updated/5d_cell_cell_communication/script")
library(CellChat)
library(patchwork)
library(stringr)
library(RColorBrewer)
options(stringsAsFactors = FALSE)
opt_server <-  TRUE
opt_data_base = "original" #"manually curated"
#define pathes and load functions
code_path = getwd()
source("utils.R")
setwd("../")
main_folder = getwd()
results_path <- paste0(main_folder,"/output/")
## load objects
cellchat_SCZ = readRDS(paste0(results_path,"cellchat_SCZ_after_filtering_DB_",opt_data_base,".rds"))
cellchat_CTRL = readRDS(paste0(results_path,"cellchat_CTRL_after_filtering_DB_",opt_data_base,".rds"))
#merge objects:
object.list <- list(CTRL = cellchat_CTRL,SCZ = cellchat_SCZ)
cellchat_combined <- mergeCellChat(object.list, add.names = names(object.list))
## visualize results
#aggregated_network
visualize_aggr_network(cellchat_SCZ,cellchat_CTRL,results_path)
#compare total number of interactions:
visualize_number_of_interactions_and_interaction_strength(cellchat_combined, results_path)
#network for specific pathways
pathways_all <- get_pathways(cellchat_SCZ,cellchat_CTRL)
pathways.show <- c("NRXN") #"SOMATOSTATIN", "VIP"
visualize_cell_cell_comm_network(cellchat_SCZ,results_path,pathways.show,"SCZ")
visualize_cell_cell_comm_network(cellchat_CTRL,results_path,pathways.show,"CTRL")
#differential number of interactions/ interaction strength
visualize_differential_number_of_interactions_and_interaction_strength(cellchat_combined, results_path)
setwd("D:/Documents/projects/SCZ_human_cortex/publication/code_updated/5d_cell_cell_communication/script")
source("utils.R")
#aggregated_network
visualize_aggr_network(cellchat_SCZ,cellchat_CTRL,results_path)
#compare total number of interactions:
visualize_number_of_interactions_and_interaction_strength(cellchat_combined, results_path)
#network for specific pathways
pathways_all <- get_pathways(cellchat_SCZ,cellchat_CTRL)
pathways.show <- c("NRXN") #"SOMATOSTATIN", "VIP"
visualize_cell_cell_comm_network(cellchat_SCZ,results_path,pathways.show,"SCZ")
visualize_cell_cell_comm_network(cellchat_CTRL,results_path,pathways.show,"CTRL")
#differential number of interactions/ interaction strength
visualize_differential_number_of_interactions_and_interaction_strength(cellchat_combined, results_path)
setwd("D:/Documents/projects/SCZ_human_cortex/publication/code_updated/5d_cell_cell_communication/script")
source("utils.R")
## visualize results
#aggregated_network
visualize_aggr_network(cellchat_SCZ,cellchat_CTRL,results_path)
#compare total number of interactions:
visualize_number_of_interactions_and_interaction_strength(cellchat_combined, results_path)
#network for specific pathways
pathways_all <- get_pathways(cellchat_SCZ,cellchat_CTRL)
pathways.show <- c("NRXN") #"SOMATOSTATIN", "VIP"
visualize_cell_cell_comm_network(cellchat_SCZ,results_path,pathways.show,"SCZ")
visualize_cell_cell_comm_network(cellchat_CTRL,results_path,pathways.show,"CTRL")
#differential number of interactions/ interaction strength
visualize_differential_number_of_interactions_and_interaction_strength(cellchat_combined, results_path)
visualize_aggr_network(cellchat_SCZ,cellchat_CTRL,results_path)
visualize_number_of_interactions_and_interaction_strength(cellchat_combined, results_path)
source("utils.R")
visualize_number_of_interactions_and_interaction_strength(cellchat_combined, results_path)
pathways_all <- get_pathways(cellchat_SCZ,cellchat_CTRL)
pathways.show <- c("NRXN") #"SOMATOSTATIN", "VIP"
visualize_cell_cell_comm_network(cellchat_SCZ,results_path,pathways.show,"SCZ")
visualize_cell_cell_comm_network(cellchat_CTRL,results_path,pathways.show,"CTRL")
gg <- netVisual_heatmap(cellchat_SCZ, signaling = pathways.show, color.heatmap = "Reds")
gg
source("utils.R")
visualize_cell_cell_comm_network(cellchat_SCZ,results_path,pathways.show,"SCZ")
gg
visualize_cell_cell_comm_network(cellchat_SCZ,results_path,pathways.show,"SCZ")
gg
ggsave(paste0(results_path,"Heatmap_communication_probabilities_SCZ.pdf"),gg)
results_path
paste0(results_path,"Heatmap_communication_probabilities_SCZ.pdf")
setwd("D:/Documents/projects/SCZ_human_cortex/publication/code_updated/5d_cell_cell_communication/script")
source("utils.R")
visualize_cell_cell_comm_network(cellchat_SCZ,results_path,pathways.show,"SCZ")
gg
ggsave(paste0(results_path,"Heatmap_communication_probabilities_SCZ.pdf"),gg)
source("utils.R")
visualize_cell_cell_comm_network(cellchat_SCZ,results_path,pathways.show,"SCZ")
source("utils.R")
visualize_cell_cell_comm_network(cellchat_SCZ,results_path,pathways.show,"SCZ")
## visualize results
#aggregated_network
visualize_aggr_network(cellchat_SCZ,cellchat_CTRL,results_path)
#compare total number of interactions:
visualize_number_of_interactions_and_interaction_strength(cellchat_combined, results_path)
#network for specific pathways
pathways_all <- get_pathways(cellchat_SCZ,cellchat_CTRL)
pathways.show <- c("NRXN") #"SOMATOSTATIN", "VIP"
visualize_cell_cell_comm_network(cellchat_SCZ,results_path,pathways.show,"SCZ")
visualize_cell_cell_comm_network(cellchat_CTRL,results_path,pathways.show,"CTRL")
#differential number of interactions/ interaction strength
visualize_differential_number_of_interactions_and_interaction_strength(cellchat_combined, results_path)
source("utils.R")
## visualize results
#aggregated_network
visualize_aggr_network(cellchat_SCZ,cellchat_CTRL,results_path)
#compare total number of interactions:
visualize_number_of_interactions_and_interaction_strength(cellchat_combined, results_path)
#network for specific pathways
pathways_all <- get_pathways(cellchat_SCZ,cellchat_CTRL)
pathways.show <- c("NRXN") #"SOMATOSTATIN", "VIP"
visualize_cell_cell_comm_network(cellchat_SCZ,results_path,pathways.show,"SCZ")
visualize_cell_cell_comm_network(cellchat_CTRL,results_path,pathways.show,"CTRL")
#differential number of interactions/ interaction strength
visualize_differential_number_of_interactions_and_interaction_strength(cellchat_combined, results_path)
source("utils.R")
## visualize results
#aggregated_network
visualize_aggr_network(cellchat_SCZ,cellchat_CTRL,results_path)
#compare total number of interactions:
visualize_number_of_interactions_and_interaction_strength(cellchat_combined, results_path)
#network for specific pathways
pathways_all <- get_pathways(cellchat_SCZ,cellchat_CTRL)
pathways.show <- c("NRXN") #"SOMATOSTATIN", "VIP"
visualize_cell_cell_comm_network(cellchat_SCZ,results_path,pathways.show,"SCZ")
visualize_cell_cell_comm_network(cellchat_CTRL,results_path,pathways.show,"CTRL")
#differential number of interactions/ interaction strength
visualize_differential_number_of_interactions_and_interaction_strength(cellchat_combined, results_path)
source("utils.R")
## visualize results
#aggregated_network
visualize_aggr_network(cellchat_SCZ,cellchat_CTRL,results_path)
#compare total number of interactions:
visualize_number_of_interactions_and_interaction_strength(cellchat_combined, results_path)
#network for specific pathways
pathways_all <- get_pathways(cellchat_SCZ,cellchat_CTRL)
pathways.show <- c("NRXN") #"SOMATOSTATIN", "VIP"
visualize_cell_cell_comm_network(cellchat_SCZ,results_path,pathways.show,"SCZ")
visualize_cell_cell_comm_network(cellchat_CTRL,results_path,pathways.show,"CTRL")
#differential number of interactions/ interaction strength
visualize_differential_number_of_interactions_and_interaction_strength(cellchat_combined, results_path)
weight.max <- getMaxWeight(object.list, attribute = c("idents","count"))
par(mfrow = c(1,2), xpd=TRUE)
for (i in 1:length(object.list)) {
netVisual_circle(object.list[[i]]@net$count, weight.scale = T, label.edge= F, edge.weight.max = weight.max[2], edge.width.max = 12, title.name = paste0("Number of interactions - ", names(object.list)[i]))
}
weight.max <- getMaxWeight(object.list, attribute = c("idents","count"))
par(mfrow = c(1,2), xpd=TRUE)
for (i in 1:length(object.list)) {
netVisual_circle(object.list[[i]]@net$count, weight.scale = T, label.edge= F, edge.weight.max = weight.max[2], edge.width.max = 12, vertex.label.cex = 0.6, title.name = paste0("Number of interactions - ", names(object.list)[i]))
}
par(mfrow = c(1,2), xpd=TRUE)
for (i in 1:length(object.list)) {
netVisual_circle(object.list[[i]]@net$weight, weight.scale = T, label.edge= F, edge.weight.max = weight.max[2], edge.width.max = 12, vertex.label.cex = 0.6, title.name = paste0("Number of interactions - ", names(object.list)[i]))
}
par(mfrow = c(1,2), xpd=TRUE)
for (i in 1:length(object.list)) {
netVisual_circle(object.list[[i]]@net$count, weight.scale = T, label.edge= F, edge.weight.max = weight.max[2], edge.width.max = 12, vertex.label.cex = 0.6, title.name = paste0("Number of interactions - ", names(object.list)[i]))
}
par(mfrow = c(1,2), xpd=TRUE)
for (i in 1:length(object.list)) {
netVisual_circle(object.list[[i]]@net$weight, weight.scale = T, label.edge= F, edge.weight.max = weight.max[2], edge.width.max = 12, vertex.label.cex = 0.6, title.name = paste0("Interaction strength - ", names(object.list)[i]))
}
weight.max
num.link <- sapply(object.list, function(x) {rowSums(x@net$count) + colSums(x@net$count)-diag(x@net$count)})
weight.MinMax <- c(min(num.link), max(num.link)) # control the dot size in the different datasets
gg <- list()
for (i in 1:length(object.list)) {
gg[[i]] <- netAnalysis_signalingRole_scatter(object.list[[i]], title = names(object.list)[i], weight.MinMax = weight.MinMax)
}
patchwork::wrap_plots(plots = gg)
netAnalysis_computeCentrality(cellchat_SCZ)
netAnalysis_computeCentrality(cellchat_CTRL)
num.link <- sapply(object.list, function(x) {rowSums(x@net$count) + colSums(x@net$count)-diag(x@net$count)})
weight.MinMax <- c(min(num.link), max(num.link)) # control the dot size in the different datasets
gg <- list()
for (i in 1:length(object.list)) {
gg[[i]] <- netAnalysis_signalingRole_scatter(object.list[[i]], title = names(object.list)[i], weight.MinMax = weight.MinMax)
}
patchwork::wrap_plots(plots = gg)
netAnalysis_computeCentrality(cellchat_combined)
object.list
cellchat_combined
object.list
cellchat_combined <- mergeCellChat(object.list, add.names = names(object.list))
num.link <- sapply(object.list, function(x) {rowSums(x@net$count) + colSums(x@net$count)-diag(x@net$count)})
weight.MinMax <- c(min(num.link), max(num.link)) # control the dot size in the different datasets
gg <- list()
for (i in 1:length(object.list)) {
gg[[i]] <- netAnalysis_signalingRole_scatter(object.list[[i]], title = names(object.list)[i], weight.MinMax = weight.MinMax)
}
patchwork::wrap_plots(plots = gg)
View(netAnalysis_computeCentrality)
cellchat_SCZ <- netAnalysis_computeCentrality(cellchat_SCZ)
cellchat_CTRL <- netAnalysis_computeCentrality(cellchat_CTRL)
cellchat_combined <- mergeCellChat(object.list, add.names = names(object.list))
num.link <- sapply(object.list, function(x) {rowSums(x@net$count) + colSums(x@net$count)-diag(x@net$count)})
weight.MinMax <- c(min(num.link), max(num.link)) # control the dot size in the different datasets
gg <- list()
for (i in 1:length(object.list)) {
gg[[i]] <- netAnalysis_signalingRole_scatter(object.list[[i]], title = names(object.list)[i], weight.MinMax = weight.MinMax)
}
patchwork::wrap_plots(plots = gg)
num.link
weight.MinMax
gg <- list()
gg[[1]] <- netAnalysis_signalingRole_scatter(cellchat_SCZ, title = "SCZ", weight.MinMax = weight.MinMax)
gg[[2]] <- netAnalysis_signalingRole_scatter(cellchat_CTRL, title = "CTRL", weight.MinMax = weight.MinMax)
patchwork::wrap_plots(plots = gg)
setwd("D:/Documents/projects/SCZ_human_cortex/publication/code_updated/5d_cell_cell_communication/script")
source("utils.R")
ingoing_vs_outgoing_interaction_strength_per_celltype(cellchat_SCZ,cellchat_CTRL,results_path)
levels(object@idents$joint)
levels(cellchat_combined@idents$joint)
gg1 <- netAnalysis_signalingChanges_scatter(cellchat, idents.use = "Oligodendrocytes")
gg2 <- netAnalysis_signalingChanges_scatter(cellchat, idents.use = "Inh SST")
patchwork::wrap_plots(plots = list(gg1,gg2))
gg1 <- netAnalysis_signalingChanges_scatter(cellchat_combined, idents.use = "Oligodendrocytes")
gg2 <- netAnalysis_signalingChanges_scatter(cellchat_combined, idents.use = "Inh SST")
patchwork::wrap_plots(plots = list(gg1,gg2))
gg1 <- netAnalysis_signalingChanges_scatter(cellchat_SCZ, idents.use = "Oligodendrocytes")
gg2 <- netAnalysis_signalingChanges_scatter(cellchat_CTRL, idents.use = "Oligodendrocytes")
#gg2 <- netAnalysis_signalingChanges_scatter(cellchat_combined, idents.use = "Inh SST")
patchwork::wrap_plots(plots = list(gg1,gg2))
gg1
netAnalysis_signalingChanges_scatter(cellchat_SCZ, idents.use = "Oligodendrocytes")
gg1 <- netAnalysis_signalingChanges_scatter(cellchat_combined, idents.use = "Oligodendrocytes")
cellchat_SCZ <- computeCommunProbPathway(cellchat_SCZ)
cellchat_CTRL <- computeCommunProbPathway(cellchat_CTRL)
object.list <- list(CTRL = cellchat_CTRL,SCZ = cellchat_SCZ)
cellchat_combined <- mergeCellChat(object.list, add.names = names(object.list),cell.prefix=TRUE)
gg1 <- netAnalysis_signalingChanges_scatter(cellchat_combined, idents.use = "Oligodendrocytes")
gg2 <- netAnalysis_signalingChanges_scatter(cellchat_combined, idents.use = "Inh SST")
patchwork::wrap_plots(plots = list(gg1,gg2))
patchwork::wrap_plots(plots = list(gg1,gg2))
levels(cellchat_combined@idents$joint)
source("utils.R")
visualize_ingoing_vs_outgoing_signaling_changes_per_celltype(cellchat_combined,results_path)
source("utils.R")
visualize_ingoing_vs_outgoing_signaling_changes_per_celltype(cellchat_combined,results_path)
source("utils.R")
visualize_ingoing_vs_outgoing_interaction_strength_per_celltype(cellchat_SCZ,cellchat_CTRL,results_path)
source("utils.R")
visualize_ingoing_vs_outgoing_signaling_changes_per_celltype(cellchat_combined,results_path)
source("utils.R")
visualize_ingoing_vs_outgoing_signaling_changes_per_celltype(cellchat_combined,results_path)
source("utils.R")
visualize_ingoing_vs_outgoing_signaling_changes_per_celltype(cellchat_combined,results_path)
source("utils.R")
visualize_ingoing_vs_outgoing_signaling_changes_per_celltype(cellchat_combined,results_path)
#Identify signaling groups based on their functional similarity
cellchat_combined <- computeNetSimilarityPairwise(cellchat_combined, type = "functional")
cellchat_combined <- netEmbedding(cellchat_combined, type = "functional")
cellchat_combined <- netClustering(cellchat_combined, type = "functional")
# Visualization in 2D-space
netVisual_embeddingPairwise(cellchat_combined, type = "functional", label.size = 3.5)
# netVisual_embeddingZoomIn(cellchat_combined, type = "functional", nCol = 2)
#Identify signaling groups based on structure similarity
cellchat_combined <- computeNetSimilarityPairwise(cellchat_combined, type = "structural")
cellchat_combined <- netEmbedding(cellchat_combined, type = "structural")
cellchat_combined <- netClustering(cellchat_combined, type = "structural")
# Visualization in 2D-space
netVisual_embeddingPairwise(cellchat_combined, type = "structural", label.size = 3.5)
netVisual_embeddingPairwiseZoomIn(cellchat_combined, type = "structural", nCol = 2)
source("utils.R")
visualize_differential_number_of_interactions_and_interaction_strength(cellchat_combined, results_path)
source("utils.R")
#aggregated_network
visualize_aggr_network(cellchat_SCZ,cellchat_CTRL,results_path)
#compare total number of interactions:
visualize_number_of_interactions_and_interaction_strength(cellchat_combined, results_path)
#network for specific pathways
pathways_all <- get_pathways(cellchat_SCZ,cellchat_CTRL)
pathways.show <- c("NRXN") #"SOMATOSTATIN", "VIP"
visualize_cell_cell_comm_network(cellchat_SCZ,results_path,pathways.show,"SCZ")
visualize_cell_cell_comm_network(cellchat_CTRL,results_path,pathways.show,"CTRL")
#differential number of interactions/ interaction strength
visualize_differential_number_of_interactions_and_interaction_strength(cellchat_combined, results_path)
#ingoing vs outgoing interaction strength per cell type
visualize_ingoing_vs_outgoing_interaction_strength_per_celltype(cellchat_SCZ,cellchat_CTRL,results_path)
#Identify signaling changes associated with one cell group
visualize_ingoing_vs_outgoing_signaling_changes_per_celltype(cellchat_combined,results_path)
View(netVisual_diffInteraction)
View(netVisual_heatmap)
source("utils.R")
#ingoing vs outgoing interaction strength per cell type
visualize_ingoing_vs_outgoing_interaction_strength_per_celltype(cellchat_SCZ,cellchat_CTRL,results_path)
#ingoing vs outgoing interaction strength per cell type
visualize_ingoing_vs_outgoing_interaction_strength_per_celltype(cellchat_SCZ,cellchat_CTRL,results_path)
source("utils.R")
visualize_ingoing_vs_outgoing_interaction_strength_per_celltype(cellchat_SCZ,cellchat_CTRL,results_path)
View(netAnalysis_signalingChanges_scatter)
source("utils.R")
visualize_ingoing_vs_outgoing_signaling_changes_per_celltype(cellchat_combined,results_path,pathways_all)
source("utils.R")
visualize_ingoing_vs_outgoing_signaling_changes_per_celltype(cellchat_combined,results_path)
View(netAnalysis_signalingChanges_scatter)
